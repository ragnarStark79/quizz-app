{% extends "base.html" %}
{% block title %}Support Management â€“ Admin{% endblock %}

{% block content %}
<div class="page-shell">
  <div class="page-header anim-fade">
    <div class="page-header-icon" style="background:linear-gradient(135deg,#f59e0b,#ef4444);">ğŸ«</div>
    <div>
      <h1>Support Management</h1>
      <p>View and reply to user tickets.</p>
    </div>
    <a href="{{ url_for('admin.index') }}" class="btn btn-secondary" style="margin-left:auto;">â† Admin Dash</a>
  </div>

  <div class="filter-row mb-6">
    <a href="{{ url_for('admin.support_tickets', status='open') }}"
      class="filter-pill {{ 'filter-pill-active' if current_filter == 'open' else 'filter-pill-inactive' }}">ğŸŸ¢ Open</a>
    <a href="{{ url_for('admin.support_tickets', status='all') }}"
      class="filter-pill {{ 'filter-pill-active' if current_filter == 'all' else 'filter-pill-inactive' }}">ğŸ“‹ All</a>
    <a href="{{ url_for('admin.support_tickets', status='closed') }}"
      class="filter-pill {{ 'filter-pill-active' if current_filter == 'closed' else 'filter-pill-inactive' }}">âš«
      Closed</a>
  </div>

  <div class="table-wrap">
    {% if tickets %}
    <table class="premium-table">
      <thead>
        <tr>
          <th>Subject</th>
          <th>User</th>
          <th>Date</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        {% for ticket in tickets %}
        <tr>
          <td>
            <a href="{{ url_for('support.view_ticket', ticket_id=ticket.id) }}"
              style="font-weight:700;color:var(--primary);">{{ ticket.subject }}</a>
            <div style="font-size:var(--fs-xs);color:var(--text-faint);margin-top:2px;">{{ ticket.replies.count() }}
              replies</div>
          </td>
          <td style="font-weight:500;">{{ ticket.user.username }}</td>
          <td style="font-size:var(--fs-xs);color:var(--text-faint);">{{ ticket.created_at.strftime('%b %d, %H:%M') }}
          </td>
          <td>
            {% if ticket.status == 'open' %}<span class="badge badge-success">Open</span>
            {% else %}<span class="badge badge-neutral">Closed</span>{% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <div class="text-center" style="padding:var(--sp-10);color:var(--text-faint);font-weight:600;">No tickets matching
      this status.</div>
    {% endif %}
  </div>
</div>
{% endblock %}